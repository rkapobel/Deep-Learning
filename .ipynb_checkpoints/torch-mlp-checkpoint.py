{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import torch"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "P = 100\n",
    "N = 8\n",
    "H = N + 1\n",
    "M = 1\n",
    "x = torch.randn( P, N).sign()\n",
    "z = torch.prod( x, dim=1).view(P,1)\n",
    "w1 = torch.randn( N+1, H, requires_grad=True)\n",
    "w2 = torch.randn( H+1, M, requires_grad=True)\n",
    "bias = torch.ones( P, 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "100 0.20009172439575196\n",
      "200 0.20009080886840822\n",
      "300 0.20008987426757813\n",
      "400 0.2000889778137207\n",
      "500 0.20008808135986328\n",
      "600 0.2000872039794922\n",
      "700 0.2000863265991211\n",
      "800 0.20008550643920897\n",
      "900 0.20008466720581056\n",
      "1000 0.2000838851928711\n",
      "1100 0.20008308410644532\n",
      "1200 0.20008224487304688\n",
      "1300 0.20008153915405275\n",
      "1400 0.2000807762145996\n",
      "1500 0.2000800132751465\n",
      "1600 0.20007930755615233\n",
      "1700 0.20007862091064454\n",
      "1800 0.20007787704467772\n",
      "1900 0.20007719039916994\n",
      "2000 0.20007650375366212\n",
      "2100 0.20007585525512694\n",
      "2200 0.20007518768310548\n",
      "2300 0.2000745391845703\n",
      "2400 0.20007389068603515\n",
      "2500 0.20007326126098632\n",
      "2600 0.20007265090942383\n",
      "2700 0.2000720977783203\n",
      "2800 0.20007148742675782\n",
      "2900 0.20007091522216797\n",
      "3000 0.2000703239440918\n",
      "3100 0.20006977081298827\n",
      "3200 0.20006919860839845\n",
      "3300 0.20006866455078126\n",
      "3400 0.20006813049316408\n",
      "3500 0.20006757736206054\n",
      "3600 0.20006706237792968\n",
      "3700 0.20006654739379884\n",
      "3800 0.20006607055664063\n",
      "3900 0.20006553649902345\n",
      "4000 0.2000650405883789\n",
      "4100 0.20006460189819336\n",
      "4200 0.2000640869140625\n",
      "4300 0.2000636100769043\n",
      "4400 0.2000631332397461\n",
      "4500 0.20006271362304687\n",
      "4600 0.20006223678588866\n",
      "4700 0.2000617790222168\n",
      "4800 0.20006134033203124\n",
      "4900 0.20006086349487304\n",
      "5000 0.20006048202514648\n",
      "5100 0.2000600814819336\n",
      "5200 0.20005966186523438\n",
      "5300 0.2000592041015625\n",
      "5400 0.20005882263183594\n",
      "5500 0.2000583839416504\n",
      "5600 0.20005802154541016\n",
      "5700 0.2000576400756836\n",
      "5800 0.2000572395324707\n",
      "5900 0.20005685806274415\n",
      "6000 0.2000564956665039\n",
      "6100 0.200056095123291\n",
      "6200 0.20005578994750978\n",
      "6300 0.20005538940429687\n",
      "6400 0.20005504608154298\n",
      "6500 0.20005470275878906\n",
      "6600 0.2000543212890625\n",
      "6700 0.20005399703979493\n",
      "6800 0.20005369186401367\n",
      "6900 0.20005332946777343\n",
      "7000 0.20005300521850586\n",
      "7100 0.20005266189575197\n",
      "7200 0.20005233764648436\n",
      "7300 0.20005203247070313\n",
      "7400 0.20005170822143556\n",
      "7500 0.20005138397216796\n",
      "7600 0.20005109786987305\n",
      "7700 0.20005077362060547\n",
      "7800 0.20005048751831056\n",
      "7900 0.2000501823425293\n",
      "8000 0.20004989624023437\n",
      "8100 0.2000495719909668\n",
      "8200 0.20004932403564454\n",
      "8300 0.2000490379333496\n",
      "8400 0.20004873275756835\n",
      "8500 0.20004842758178712\n",
      "8600 0.20004819869995116\n",
      "8700 0.20004791259765625\n",
      "8800 0.20004762649536134\n",
      "8900 0.20004735946655272\n",
      "9000 0.20004711151123047\n",
      "9100 0.20004684448242188\n",
      "9200 0.2000465965270996\n",
      "9300 0.2000463104248047\n",
      "9400 0.20004606246948242\n",
      "9500 0.20004581451416015\n",
      "9600 0.2000455665588379\n",
      "9700 0.20004533767700194\n",
      "9800 0.20004510879516602\n",
      "9900 0.20004484176635742\n"
     ]
    }
   ],
   "source": [
    "lr = 1e-2\n",
    "t, e = 0, 1\n",
    "while e > 0.001 and t < 9999:\n",
    "    h = torch.cat((x,bias), dim=1).mm(w1).tanh()\n",
    "    y = torch.cat((h,bias), dim=1).mm(w2).tanh()\n",
    "    error = (y-z).pow(2).sum()\n",
    "    error.backward()\n",
    "    with torch.no_grad():\n",
    "        w1 -= lr*w1.grad\n",
    "        w2 -= lr*w2.grad\n",
    "        w1.grad.zero_()\n",
    "        w2.grad.zero_()\n",
    "    e = error.item()/P\n",
    "    t += 1\n",
    "    if t%100==0:\n",
    "        print(t,e)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
